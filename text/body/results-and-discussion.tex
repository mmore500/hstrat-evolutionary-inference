\section{Results and Discussion} \label{sec:results}

\subsection{Phylometric Signatures of Evolutionary Dynamics}

\input{fig/perfect-tree-phylometrics.tex}

The feasibility of harnessing phylogenetic analysis to characterize evolutionary dynamics in digital evolution systems hinges on the premise that these dynamics induce detectable structure within the phylogenetic record.
In order to explore this tenet, we compared distributions of phylogenetic metrics yielded across replicate runs under different sets of evolutionary conditions. Figure \ref{fig:perfect-tree-phylometrics} summarizes these distributions.  Indeed, statistical tests confirmed that each phylometric exhibited significant  variation among surveyed evolutionary conditions (Kruskal-Wallis tests; all $p < 1\times10^{-50}$; $n=50$ per condition; Supplementary Table tab:perfect-tree-phylometrics-kruskal).

To better understand, we performed an all-pairs comparison of each phylometric among the seven surveyed evolutionary regimes (Wilcoxon tests with Bonferoni correction; corrected significance thresh $1.49 \times 10^{-4}$; $n=50$ per condition; 84 comparisons per sensitivity analysis configuration; 336 comparisons total; Supplementary Table tab:perfect-tree-phylometrics-wilcox).

 The Colless-like index is significantly depressed under all evolutionary regimes compared to the plain regime with no spatial structure, no ecology,  and moderate selection pressure.
Reduction in this statistic indicates that all deviations from baseline conditions increased regularity in generated phylogenies.
This observation runs somewhat counter to prior results on similar tree balance metrics, in which the presence of spatial structure increased imbalance \citep{scottInferringTumorProliferative2020}
Application of the metric to trees comprised individual-level taxa, instead of species-level taxa as is the case in most traditional phylogenetics work, may account for this result.
Further investigation will be warranted to fully explain this outcome. 

Compared to the plain regime, observed mean pairwise distance was significantly lower under strong selection and significantly higher under weak selection and with spatial structure.
None of the ecological regimes induced significant changes in the mean pairwise distance phylometric compared to the plain regime.

Similarly, ancestor account had no significant relationship with ecology. However, weak selection and spatial structure significantly increased ancestor count and strong selection significantly decreased it.

Finally, mean evolutionary distinctiveness was significantly increased under all three ecological regimes compared to baseline.
Additional, ecological intensity was significantly associated with mean evolutionary distinctiveness, with weak 4 niche ecology having the lowest value for this phylometric and 8 niche ecology having the highest.
However, evolutionary distinctiveness was more strongly driven by weak selection and even more strongly driven by spatial structure, by significant margins.
Finally, strong selection significantly depressed mean evolutionary distinctiveness. 

\input{fig/perfect-tree-phylometrics-heatmap.tex}

Figure \ref{fig:perfect-tree-phylometrics-heatmap} provides a high-level overview of the magnitude and direction of each regime's effects on evolutionary metrics compared to the plain regime.
Notably, strong and weak selection both significantly decrease Colless-like index and mean pairwise distance but have opposite effects on ancestor count and mean evolutionary distinctiveness.
Colless-like distance appears to be the least useful metric in distinguishing evolutionary dynamics, decreasing under all non-plain evolutionary conditions.

Ecological dynamics have significant, but relatively weak, influence on the surveyed phylometrics.
So, it appears careful accounting for other evolutionary dynamics (i.e., selection pressure and spatial structure) will be essential to accurate detection of ecology through phylogenetic analysis.
Ancestor count and mean pairwise distance may play a role in identifying ecological dynamics, as ecological dynamics --- in contrast to other factors such as spatial structure and changes in selection pressure --- have little to no discernible effect on these phylometrics. 
Alternately, in future work it may be possible to develop phylometrics that respond more strongly --- and more exclusively --- to ecological dynamics.

We performed a sensitivity analysis over an alternate exponential mutation operator and earlier phylogeny sampling timepoints.
We found the effects of evolutionary conditions on phylometrics to be generally consistent across surveyed conditions (Supplementary Figures \ref{fig:perfect-tree-phylometrics-sensitivity-analysis} and \ref{fig:perfect-tree-phylometrics-heatmap-sensitivity-analysis}; Supplementary Tables tab:perfect-tree-phylometrics-kruskal and tab:perfect-tree-

\subsection{Phylometric Signatures of Ecological Dynamics in Spatially Structured Populations}

\input{fig/perfect-tree-phylometrics-with-spatial-nuisance.tex}

At large scale, digital evolution populations will almost inevitably integrate spatial structure due to practical limitations of distributed computing hardware \citep{ackley2014indefinitely}.
Therefore, understanding the background effects of spatial structure on the phylogenetic signatures of other evolutionary dynamics will be essential to applications of phylogenetic inference in such applications.
For this analysis, we chose to focus on ecological dynamics due to interest in how their relatively weak phylometric signatures would respond to the relatively strong influence of spatial structure.

Figure \ref{fig:perfect-tree-phylometrics-with-spatial-nuisance} summarizes the distribution of surveyed phylometrics under the three surveyed ecological regimes and the control non-ecological regime, all with spatial population structure.
Statistical tests confirmed that each phylometric exhibited significant  variation among these evolutionary regimes (Kruskal-Wallis tests; all $p < 1\times10^{-20}$; $n=50$ per condition; Supplementary Table perfect-tree-phylometrics-with-spatial-nuisance-kruskal).

To explore the nature of this variation, we performed all-pairs comparisons for each phylometric among the four surveyed regimes (Wilcoxon tests with Bonferoni correction; corrected significance threshold $5.26 \times 10^{-4}$; $n=50$ per condition; 24 comparisons per sensitivity analysis configuration; 96 comparisons total; Supplementary Table perfect-tree-phylometrics-with-spatial-nuisance-wilcox).
Like under the spatially unstructured background, ecology drove significant increases and mean evolutionary distinctiveness. 
Unlike the spatially unstructured background, though, ancestor count under ecological conditions sharply exceeded ancestor count under non-ecological conditions.
Ancestor count significantly increased between the 4 niche ecological regimes and the 8 niche ecological regime, as well.
Additionally,  the 8 niche regime significantly decreases mean pairwise distance under under spatially-structured conditions.
This was not the case without spatial structure.

Spatial structure appears to mediate these aspects of ecological phylogenetic structure, they do not appear in its absence.
However, spatial structure mutes the effects of ecology on the Colless-like index.
Only the 8 niche regime significantly decreased this phylometric. 

For these experiments, we again performed a sensitivity analysis over an alternate exponential mutation operator and earlier phylogeny sampling timepoints.
We found the effects of evolutionary conditions on phylometrics to be generally consistent across surveyed conditions (Supplementary Figure \ref{fig:perfect-tree-phylometrics-sensitivity-analysis-with-spatial-nuisance} and Supplementary Tables tab:perfect-tree-phylometrics-with-spatial-nuisance-kruskal and tab:perfect-tree-phylometrics-with-spatial-nuisance-wilcox). 

\subsection{Phylometric Bias of Reconstruction Error} \label{sec:phylometric-bias-reconstruction-error}

Shifting from perfect phylogenetic tracking to approxmate phylogentic reconstruction will facilitate efficiency and robust digital evolution simulations at scale, but introduces a complicating factor into phylogenetic analyses: tree reconstruction error.
A clear understanding of the impact of these errors on the computed phylometrics will be necessary to ensure accurate phylogenetic analyses.

To explore this question, we compared phylometrics computed on reconstructed trees to corresponding true reference trees (Wilcoxon tests; $n=50$ per condition; Table \ref{reconstructed-tree-phylometrics-error-wilcox}).
To err towards conservatism in detecting phylometric biases, we did not correct for multiple comparisons.
Reconstructions were performed across a range of precisions, ranging from 1\% relative resolution for MRCA estimates (most precise) to 33\% relative resolution for MRCA estimates (least precise).
Precision was manipulated by adjusting the information content of underlying hereditary stratigraphic genome annotations used to perform phylogenetic reconstruction \citep{moreno2022hereditary}.

\input{fig/reconstructed-tree-phylometrics-error.tex}

For each phylometric, we sought to determine the minimum resolution required to achieve statistical non-detection (i.e., $p > 0.05$) of bias between reconstructions and their corresponding references. 
For most phylometrics, 3\% reconstruction resolution was sufficient to achieve statistical indistinguishability between reference and reconstruction.
Mean evolutionary distinctiveness was particularly robust to reconstruction error, showing no detectable bias even at only 33\% reconstruction resolution. 
Ancestor count was highly sensitive to reconstruction error; in nearly all cases bias was still detectable at 1\% reconstruction resolution.
This may be due to overabundance of polytomies in reconstructed trees due to aggregation of ancestors that cannot be resolved due to estimation uncertainty.
In future work, postprocessing reconstructed trees to break polytomies into arbitrary sets of bifurcations may reduce this metric's sensitivity to reconstruction.

Phylometric sensitivity to reconstruction error was broadly consistent across evolutionary regimes.
Figure \ref{fig:reconstructed-tree-phylometrics-error} summarizes these results.

Where detectable, estimation uncertainty bias decreased all surveyed phylometrics' numerical value.
So, when testing for expected increases in phylometric values, the potential for systematic false positives due to reconstruction error can be discounted. 
Supplementary Figure \ref{reconstructed-tree-phylometrics} provides a full comparison the distribution of phylometric estimates on reference trees with the distributions of phylometric estimates for reconstructed trees across reconstruction resolutions.

We performed additional analyses with additional spatially structured ecological evolutionary regimes, over an alternate exponential mutation operator, and at earlier phylogeny sampling timepoints.
These yielded generally similar findings for the relationship between reconstruction error and phylometric bias (Supplementary Figures \ref{fig:reconstructed-tree-phylometrics-error-sensitivity-analysis}; \ref{fig:reconstructed-tree-phylometrics-error-spatial-nuisance}, and \ref{fig:reconstructed-tree-phylometrics-with-spatial-nuisance};  Table \ref{reconstructed-tree-phylometrics-error-wilcox}).

